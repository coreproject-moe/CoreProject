{% extends 'tailwind_base.html' %}
{% load static django_vite %}


{% block head %}
    {% vite_asset 'js/vendor/easytimer.ts' %}
    {% component_css_dependencies %}
    <title>AnimeCore</title>
{% endblock %}

{% block body %}
    <div class="relative h-[100dvh] bg-secondary">
        <div class="w-full h-full flex flex-col overflow-hidden">
            <header class="flex-none z-10">
                <navbar class="absolute top-0 flex h-[4.5rem] w-full items-center justify-between bg-surface-900/95 px-4 backdrop-blur-3xl md:static md:h-[10vh] md:bg-surface-900 md:py-[0.9375vw] md:pl-[2.1vw] md:pr-[3.75vw]">
                    <a href="/">
                        <coreproject-icon-coreproject class="w-9 md:w-[2.25vw] md:pt-[0.75vw]"></coreproject-icon-coreproject>
                    </a>
                    <div class="relative flex items-center md:static">
                        <div class="absolute left-1/2 -translate-x-1/2">
                            <a href="/anime" class="hidden md:flex">
                                <coreproject-icon-animecore class="w-[10vw]" ></coreproject-icon-animecore>
                            </a>
                            <search-form>
                                <form class="relative flex h-12 w-[65vw] items-center md:hidden">
                                    <button class="btn absolute left-4 p-0" aria-label="Search">
                                        <coreproject-icon-search class="w-5 opacity-75"></coreproject-icon-search>
                                    </button>
                                    <input
                                        type="text"
                                        placeholder="Search for animes, mangas..."
                                        class="h-full w-full rounded-[0.4rem] border-none bg-surface-400 pl-12 text-sm font-semibold text-white shadow-lg !ring-0 placeholder:font-medium placeholder:text-surface-200"
                                    />
                                </form>
                            </search-form>
                        </div>
                    </div>
                    <button class="avatar" aria-label="Avatar" aria-expanded="false">
                        <figure
                            class="avatar flex aspect-square text-surface-50 font-semibold justify-center items-center overflow-hidden isolate bg-surface-400-500-token w-12 md:w-[3.125vw] rounded-[0.4rem] md:rounded-[0.375vw]"
                            data-testid="avatar"
                        >
                            <img class="avatar-image w-full h-full object-cover" style="" src="/images/Avatar.avif" alt="" />
                        </figure>
                    </button>
                </navbar>
            </header>
            <div class="flex-auto w-full h-full flex overflow-hidden">
                <aside class="flex-none overflow-x-hidden overflow-y-auto w-auto">
                    <div class="hidden h-full w-[6.25vw] flex-col justify-between py-[2vw] md:flex">
                        <div>
                            <div class="flex flex-col items-center">
                                <button onclick="search_model.showModal()" type="button" class="btn btn-warning w-[3vw] h-[3vw] p-0 rounded-[0.5vw]">
                                    <coreproject-icon-search  class="w-[1.25vw] text-black" ></coreproject-icon-search>
                                </button>
                            </div>
                            <dialog id="search_model" class="modal">
                              <div class="modal-box w-11/12 max-w-5xl">
                                <h3 class="font-bold text-lg">Hello!</h3>
                                <p class="py-4">Click the button below to close</p>
                                <div class="modal-action">
                                  <form method="dialog">
                                    <!-- if there is a button, it will close the modal -->
                                    <button class="btn">Close</button>
                                  </form>
                                </div>
                              </div>
                            </dialog>
                            {% component_block "vercel_hover" glider_container_class='mt-[2.8125vw] flex flex-col items-center gap-[0.75vw]' active_element_class='rounded-[0.75vw] bg-white/10' direction='vertical' duration=200 %}
                                {% fill 'items' %}
                                    {% for icon in icons %}

                                        <button
                                            type="button"
                                            _="
                                               on hyperscript:change(url)
                                               if url !== '{{icon.href}}'
                                               put 'btn btn-icon relative w-[4vw] h-[4vw] border-none rounded-[0.75vw] p-0 !bg-transparent' into my.classList
                                               remove .hidden from <span/> in me
                                               else
                                               put 'btn btn-icon relative w-[4vw] h-[4vw] border-none rounded-[0.75vw] p-0 relative !bg-accent before:absolute before:-left-[0.15vw] before:z-10 before:h-[1.25vw] before:w-[0.25vw] before:rounded-full before:bg-primary-500' into my.classList
                                               end

                                               on htmx:afterRequest
                                               add .blur-sm
                                               then wait 100ms

                                               send hyperscript:change(url:event.detail.pathInfo.responsePath) to <icon/> in <glider-container/>
                                               send hyperscript:change(url:event.detail.pathInfo.responsePath) to <button/> in <glider-container/>

                                               add .hidden to <span/> in me
                                               then remove .blur-sm
                                              "
                                            hx-push-url= "{{icon.href}}"
                                            hx-get="{{icon.href}}"
                                            hx-target="#page"

                                            class="btn btn-icon relative w-[4vw] h-[4vw] border-none rounded-[0.75vw] p-0 {% if icon.href == request.path %} relative !bg-accent before:absolute before:-left-[0.15vw] before:z-10 before:h-[1.25vw] before:w-[0.25vw] before:rounded-full before:bg-primary-500 {% else %} !bg-transparent {% endif %}"
                                        >

                                            <div class="inline-grid">
                                                <div class="absolute inset-0 flex flex-col items-center justify-center gap-[0.5vw]">
                                                    <icon
                                                        _="
                                                           on hyperscript:change(url)
                                                           if url !== '{{icon.href}}'
                                                           put '!text-white' into my.classList
                                                           else
                                                           put '!text-secondary' into my.classList
                                                           end
                                                          "
                                                        class="{% if icon.href == request.path %} !text-secondary {% else %} !text-white {% endif %}"
                                                    >
                                                        {% if icon.icon %}
                                                            {{icon.icon|safe}}
                                                        {% else %}
                                                            {% include icon.html with class=icon.class %}
                                                        {% endif %}
                                                    </icon>

                                                    <span
                                                        class='text-[0.75vw] font-semibold capitalize leading-[1.05vw] {% if icon.href == request.path %} hidden {%endif%}'
                                                    >
                                                        {{ icon.label }}
                                                    </span>
                                                </div>
                                            </div>
                                        </button>
                                    {% endfor %}
                                {% endfill %}
                            {% endcomponent_block %}
                        </div>
                        <div class="flex flex-col items-center">
                            <button type="button" class="btn !bg-transparent w-[4vw] h-[4vw] flex-col justify-center gap-[0.45vw] p-0 text-sm">
                                <coreproject-icon-settings class="w-[1.25vw] text-white"></coreproject-icon-settings>
                                <span class="!m-0 text-[0.75vw] font-semibold capitalize leading-[1.05vw]">
                                    settings
                                </span>
                            </button>
                            <button type="button" class="btn !bg-transparent w-[4vw] h-[4vw] flex-col justify-center gap-[0.45vw] p-0 text-sm">
                                <coreproject-icon-misc class="w-[1.25vw] text-white"></coreproject-icon-misc>
                                <span class="!m-0 text-[0.75vw] font-semibold capitalize leading-[1.05vw]">
                                    misc.
                                </span>
                            </button>
                        </div>
                    </div>
                </aside>
                <div id="page" class="flex-1 overflow-x-hidden flex flex-col" style="scrollbar-gutter: auto;">
                    <content
                        class='contents'
                        hx-get='{{request.get_full_path}}'
                        hx-target='this'
                        hx-trigger='load'
                    >
                     {% comment %}
                        Everything is rendered here
                     {% endcomment %}
                    </content>
                </div>
            </div>
            <footer id="shell-footer" class="flex-none">
                <div class="flex h-24 items-center justify-center md:hidden">
                    <div class="flex items-start justify-center gap-5">
                        <a href="/anime" type="button" class="flex flex-col items-center gap-[0.5vh]">
                            <div class="bg-primary-500 btn btn-icon h-12 w-20 rounded-xl p-0">
                                <div>
                                    <svg class="w-5" viewBox="0 0 20 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M7.99961 16V12C7.99961 11.4477 8.44733 11 8.99961 11H10.9996C11.5519 11 11.9996 11.4477 11.9996 12V16C11.9996 16.55 12.4496 17 12.9996 17H15.9996C16.5496 17 16.9996 16.55 16.9996 16V9.99997C16.9996 9.44769 17.4473 8.99997 17.9996 8.99997H18.6996C19.1596 8.99997 19.3796 8.42997 19.0296 8.12997L10.6696 0.599971C10.2896 0.259971 9.70961 0.259971 9.32961 0.599971L0.96961 8.12997C0.62961 8.42997 0.83961 8.99997 1.29961 8.99997H1.99961C2.55189 8.99997 2.99961 9.44769 2.99961 9.99997V16C2.99961 16.55 3.44961 17 3.99961 17H6.99961C7.54961 17 7.99961 16.55 7.99961 16Z"
                                            fill="currentColor"
                                        ></path>
                                    </svg>
                                </div>
                            </div>
                            <span class="text-xs font-bold capitalize text-surface-50">home</span>
                        </a>
                        <a href="/anime/explore" type="button" class="flex flex-col items-center gap-[0.5vh]">
                            <div class="bg-initial btn btn-icon h-12 w-20 rounded-xl p-0">
                                <div>
                                    <svg class="w-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M10 0C4.48 0 0 4.48 0 10C0 15.52 4.48 20 10 20C15.52 20 20 15.52 20 10C20 4.48 15.52 0 10 0ZM10 18C5.59 18 2 14.41 2 10C2 5.59 5.59 2 10 2C14.41 2 18 5.59 18 10C18 14.41 14.41 18 10 18ZM5.65317 13.0185C5.26027 13.864 6.13598 14.7397 6.98146 14.3468L11.3472 12.318C11.7752 12.1191 12.1191 11.7752 12.318 11.3472L14.3468 6.98146C14.7397 6.13599 13.864 5.26026 13.0185 5.65317L8.65283 7.68197C8.22479 7.88089 7.88089 8.22479 7.68197 8.65283L5.65317 13.0185ZM10 8.9C10.61 8.9 11.1 9.39 11.1 10C11.1 10.61 10.61 11.1 10 11.1C9.39 11.1 8.9 10.61 8.9 10C8.9 9.39 9.39 8.9 10 8.9Z"
                                            fill="currentColor"
                                        ></path>
                                    </svg>
                                </div>
                            </div>
                            <span class="text-xs font-bold capitalize text-surface-50">explore</span>
                        </a>
                        <a href="/anime/forum" type="button" class="flex flex-col items-center gap-[0.5vh]">
                            <div class="bg-initial btn btn-icon h-12 w-20 rounded-xl p-0">
                                <div>
                                    <svg class="w-5" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M15.667 4.00002H15.3337C15.0575 4.00002 14.8337 4.22388 14.8337 4.50002V10.6667C14.8337 11.125 14.4587 11.5 14.0003 11.5H4.50033C4.22418 11.5 4.00033 11.7239 4.00033 12V12.3334C4.00033 13.25 4.75033 14 5.66699 14H13.7932C13.9258 14 14.053 14.0527 14.1468 14.1465L16.4801 16.4798C16.7951 16.7948 17.3337 16.5717 17.3337 16.1262V5.66669C17.3337 4.75002 16.5837 4.00002 15.667 4.00002ZM13.167 8.16669V2.33335C13.167 1.41669 12.417 0.666687 11.5003 0.666687H2.33366C1.41699 0.666687 0.666992 1.41669 0.666992 2.33335V11.9596C0.666992 12.405 1.20556 12.6281 1.52055 12.3131L3.85388 9.9798C3.94765 9.88603 4.07482 9.83335 4.20743 9.83335H11.5003C12.417 9.83335 13.167 9.08335 13.167 8.16669Z"
                                            fill="currentColor"
                                        ></path>
                                    </svg>
                                </div>
                            </div>
                            <span class="text-xs font-bold capitalize text-surface-50">forum</span>
                        </a>
                    </div>
                </div>
            </footer>
        </div>
    </div>


{% endblock %}
